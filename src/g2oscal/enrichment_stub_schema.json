{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://example.com/oscal/bsi-enrichment-stub.schema.json",
    "title": "BSI Enrichment Stub Schema",
    "description": "A schema for validating an array of practice, CIA, and class classifications generated by the AI model.",
    "type": "object",
    "required": ["enriched_requirements"],
    "properties": {
        "enriched_requirements": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                  "id",
                  "class",
                  "practice",
                  "effective_on_c",
                  "effective_on_i",
                  "effective_on_a"
                ],
                "properties": {
                  "id": { "type": "string" },
                  "class": {
                      "description": "The standard NIST class of the control.",
                      "type": "string",
                      "enum": ["Technical", "Operational", "Management"]
                  },
                  "practice": {
                    "description": "The assigned practice category.",
                    "type": "string",
                    "enum": [
                      "GOV", "ISGA", "DOCS", "RISK", "REAL", "PERF", "LAW", "ARCH", "SENS",
                      "REA", "NOT", "ASST", "TEST", "PERS", "BES", "DEV", "CON", "DLS",
                      "GEB", "BER", "DET", "SYS", "APP"
                    ]
                  },
                  "effective_on_c": { "type": "boolean" },
                  "effective_on_i": { "type": "boolean" },
                  "effective_on_a": { "type": "boolean" }
                },
                "additionalProperties": false
            }
        }
    },
    "additionalProperties": false
}